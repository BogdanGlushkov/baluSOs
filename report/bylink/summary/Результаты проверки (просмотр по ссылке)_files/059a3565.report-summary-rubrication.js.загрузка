function updateRubricView(a,b){b?(a.find(".rubric-list_selected .rubric").data("code",b.code),a.find(".rubric-list_selected .rubric > span").text(b.fullDescription||b.code+" "+b.description),a.parent().find(".collapse-panel-header span").text($.localize_report("{0} code selected","~/wwwroot/js/report/summary/summaryRubrication.js",[b.code]))):(a.find(".rubric-list_selected .rubric").data("code",null),a.find(".rubric-list_selected .rubric > span").text(""),a.parent().find(".collapse-panel-header span").text("")),a.find(".rubric-list_confirm").toggleClass("none",null!=b),a.find(".rubric-list_selected").toggleClass("none",null==b)}$(document).ready(function(){function a(){$.ajax({type:"GET",url:"/attributes/api/document/"+$documentId+"/rubricator"+getAdditionalUrl(!0),contentType:"application/json; charset=utf-8",timeout:6e4,success:function(f,g){"InProgress"==f.status?setTimeout(a,$checkStatusInterval):"Done"==f.status?(e||0!=f.rubricators.filter(function(a){return null!=a.manual}).length||$(".report-summary-metrics .rubrication > p").text($.localize_report("No rubricator codes have been confirmed or selected","~/wwwroot/js/report/summary/summaryRubrication.js")),f.rubricators.forEach(function(a){if(e||null!=a.manual){var c=$('<div class="collapse-panel">'),d=$('<div class="collapse-panel-header">'),f=$("<div>"),g=$('<div class="collapse-panel-content">'),h=$("<span>");f.append("<h3>"+a.name+"</h3>"),null!=a.manual&&h.text($.localize_report("{0} code selected","~/wwwroot/js/report/summary/summaryRubrication.js",[a.manual.code])),f.append(h),d.append(f),d.append('<i class="roll"></i>'),g.append(b(a)),c.append(d),c.append(g),$(".report-summary-metrics .rubrication").append(c),e&&setRubricatorEvents(c,a.available),c.collapsePanel({callback:function(){var b=a.type.toLowerCase();setYMSummaryReportCounter("rubric_"+b+"_expand"),setGASummaryReportCounter("rubrication","rubric_"+b+"_expand")}}),updateRubricView(g,a.manual)}}),d=!1,c.hide()):($(".report-summary-metrics .rubrication > p").replaceWith('<p class="error">'+$.localize_report("Error in determining rubricator codes. If the problem persists, contact the {0}tech support{1}","~/wwwroot/js/report/summary/summaryRubrication.js",['<a href="/page/contacts">',"</a>"])+"</p>"),d=!1,c.hide())},error:function(a,b,e){if(401==a.status)window.location.href="/";else{d=!1,c.hide();var f=new DialogHelper;f.modalText($.localize_report("Failed to get rubrication info.","~/wwwroot/js/report/summary/summaryRubrication.js"))}}})}function b(a){var b="";return e&&(b+='<div class="rubric-list rubric-list_confirm none">\n',null!=a.found&&a.found.length>0?(b+="<h4>"+$.localize_report("Confirm rubricator code","~/wwwroot/js/report/summary/summaryRubrication.js")+":</h4>\n",a.found.forEach(function(c){b+='<div class="rubric" data-code="'+c.code+'" data-type="'+a.type+'">\n<span>'+c.code+" "+c.description+"</span>\n<button>"+$.localize_report("Confirm","~/wwwroot/js/report/summary/summaryRubrication.js")+"</button>\n</div>\n"})):b+="<p>"+$.localize_report("No code defined for this rubricator. You can enter the code manually in the field below.","~/wwwroot/js/report/summary/summaryRubrication.js")+"</p>\n",b+="<h4>"+$.localize_report("Select code from list","~/wwwroot/js/report/summary/summaryRubrication.js")+':</h4>\n<div class="rubric added" data-type="'+a.type+'">\n<input type="hidden" />\n<button disabled="disabled">'+$.localize_report("Add","~/wwwroot/js/report/summary/summaryRubrication.js")+"</button>\n</div>\n",b+="</div>\n"),b+='<div class="rubric-list rubric-list_selected none">\n<h4>'+$.localize_report("Rubricator code","~/wwwroot/js/report/summary/summaryRubrication.js")+":</h4>\n",b+='<div class="rubric selected" data-type="'+a.type+'" >\n<span></span>\n',e&&(b+="<button>"+$.localize_report("Reset","~/wwwroot/js/report/summary/summaryRubrication.js")+"</button>\n"),b+="</div>\n",b+="</div>\n",b}var c=$(".report-summary-metrics .rubrication .loading"),d=!0,e="function"==typeof setRubricatorEvents;c.loader({color:"white"}),c.show(),a()});